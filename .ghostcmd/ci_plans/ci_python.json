{
  "plan": {
    "name": "CI (Generated by GhostCMD)",
    "on": {
      "push": {
        "branches": [
          "main"
        ]
      },
      "pull_request": {},
      "workflow_dispatch": {}
    },
    "env": {
      "PYTHONUNBUFFERED": "1"
    },
    "jobs": [
      {
        "id": "lint",
        "runs_on": "ubuntu-latest",
        "steps": [
          {
            "type": "checkout"
          },
          {
            "type": "setup_python",
            "version": "3.11"
          },
          {
            "type": "cache_pip",
            "key": "pip-cache"
          },
          {
            "type": "run",
            "cmd": "python -m pip install --upgrade pip black"
          },
          {
            "type": "run",
            "cmd": "black --check ."
          }
        ]
      },
      {
        "id": "test",
        "runs_on": "ubuntu-latest",
        "needs": [
          "lint"
        ],
        "steps": [
          {
            "type": "checkout"
          },
          {
            "type": "setup_python",
            "version": "3.11"
          },
          {
            "type": "cache_pip",
            "key": "pip-cache"
          },
          {
            "type": "run",
            "cmd": "python -m pip install --upgrade pip pytest pytest-cov"
          },
          {
            "type": "run",
            "cmd": "pytest -q --maxfail=1 --disable-warnings --cov=. --cov-report=xml"
          },
          {
            "type": "upload_artifact",
            "name": "coverage-xml",
            "path": "coverage.xml"
          }
        ]
      },
      {
        "id": "docker_build",
        "runs_on": "ubuntu-latest",
        "needs": [
          "lint",
          "test"
        ],
        "steps": [
          {
            "type": "checkout"
          },
          {
            "type": "docker_setup_buildx"
          },
          {
            "type": "docker_login",
            "registry": "ghcr.io",
            "user_expr": "${{ github.actor }}",
            "password_secret": "GHCR_TOKEN"
          },
          {
            "type": "docker_build_push",
            "context": ".",
            "tags": [
              "ghcr.io/${{ github.repository }}:sha-${{ github.sha }}"
            ]
          }
        ]
      }
    ],
    "intent": "python + black + pytest + coverage"
  },
  "sha256": "e9808b995c3141c8a8639bc3355146696a75bc598b99caadcea1f1167fdb9dac"
}